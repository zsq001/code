#include<iostream>
#include<cstdio>
using namespace std;
int main(){
	freopen("meal.in","r",stdin);
	freopen("meal.out","w",stdout);
	int n,m;
	scanf("%d %d",&n,&m);
	if(n==2&&m==2){
		int a[3][3],ge=0;
		for(int i=1;i<=n;i++){
			for(int j=1;j<=m;j++){
				cin>>a[i][j];ge=ge+a[i][j];
			}
		}
		if(ge==1){
			cout<<"1";return 0;
		}
		if(ge==2){
			if((a[1][1]==1&&a[2][1]==1)||(a[1][1]==1&&a[1][2]==1)||(a[2][1]==1&&a[2][2]==1)||(a[1][2]==1&&a[2][2]==1)){
				cout<<"2";return 0;
			}
			else{
				cout<<"1";return 0;
			}
		}
		if(ge==3){
			cout<<"1";return 0;
		}
		if(ge==4){
			cout<<"1";return 0;
		}
	}
	if(n==2&&m==3){
		int a[3][4],ge=0;
		for(int i=1;i<=n;i++){
			for(int j=1;j<=m;j++){
				cin>>a[i][j];ge=ge+a[i][j];
			}
		}
		if(ge==1){
			cout<<"1";return 0;
		}
		if(ge==2){
			if((a[1][1]==1&&a[2][1]==1)||(a[1][2]==1&&a[2][2]==1)||(a[1][3]==1&&a[2][3]==1)||(a[1][1]==1&&a[1][2]==1)||(a[1][2]==1&&a[2][3]==1)||(a[1][1]==1&&a[1][3]==1)||(a[2][1]==1&&a[2][2]==1)||(a[2][1]==1&&a[2][3]==1)||(a[2][2]==1&&a[2][3]==1)){
			cout<<"2";return 0;
			}
			if((a[1][1]==1&&a[2][2]==1)||(a[1][1]==1&&a[2][3]==1)||(a[1][2]==1&&a[2][1]==1)||(a[1][2]==1&&a[2][3]==1)||(a[1][3]==1&&a[2][1]==1)||(a[1][3]==1&&a[2][2]==1)){
				cout<<"1";return 0;
			}
		}
		if(ge==3){
			if((a[1][1]==1&&a[1][2]==1&&a[1][3]==1)||(a[2][1]==1&&a[2][2]==1&&a[2][3]==1)){
				cout<<"1";return 0;
			}
			if((a[1][1]==1&&a[1][2]==1&&a[2][1]==1)||(a[1][1]==1&&a[1][2]==1&&a[2][2]==1)||(a[1][1]==1&&a[2][1]==1&&a[1][3]==1)||(a[1][1]==1&&a[2][3]==1&&a[1][3]==1)){
				cout<<"1";return 0;
			}
			if((a[2][2]==1&&a[1][2]==1&&a[1][3]==1)||(a[2][3]==1&&a[1][2]==1&&a[1][3]==1)||(a[1][1]==1&&a[2][2]==1&&a[2][1]==1)||(a[2][1]==1&&a[2][2]==1&&a[1][2]==1)){
				cout<<"1";return 0;
			}
			if((a[1][1]==1&&a[2][1]==1&&a[2][3]==1)||(a[2][1]==1&&a[2][3]==1&&a[1][3]==1)||(a[1][2]==1&&a[2][2]==1&&a[2][3]==1)||(a[1][3]==1&&a[2][2]==1&&a[2][3]==1)){
				cout<<"1";return 0;
			}
			if((a[1][1]==1&&a[1][2]==1&&a[2][3]==1)||(a[1][1]==1&&a[2][2]==1&&a[1][3]==1)||(a[2][1]==1&&a[1][2]==1&&a[1][3]==1)){
				cout<<"2";return 0;
			}
			if((a[2][1]==1&&a[2][2]==1&&a[1][3]==1)||(a[2][1]==1&&a[1][2]==1&&a[2][3]==1)||(a[1][1]==1&&a[2][2]==1&&a[2][3]==1)){
				cout<<"2";return 0;
			}
		}
		if(ge==4){
			if((a[1][1]==1&&a[1][2]==1&&a[1][3]==1&&a[2][1]==1)||(a[1][1]==1&&a[1][2]==1&&a[1][3]==1&&a[2][2]==1||(a[1][1]==1&&a[1][2]==1&&a[1][3]==1&&a[2][3]==1))){
				cout<<"2";return 0;
			}
			if((a[2][1]==1&&a[2][2]==1&&a[2][3]==1&&a[1][1]==1)||(a[2][1]==1&&a[2][2]==1&&a[2][3]==1&&a[1][2]==1)||(a[2][1]==1&&a[2][2]==1&&a[2][3]==1&&a[1][3]==1)){
				cout<<"2";return 0;
			}
			if((a[1][1]==1&&a[1][2]==1&&a[2][1]==1&&a[2][2]==1)||(a[1][3]==1&&a[1][2]==1&&a[2][3]==1&&a[2][2]==1)||(a[1][1]==1&&a[1][3]==1&&a[2][3]==1&&a[2][1]==1)){
				cout<<"2";return 0;
			}
			if((a[1][1]==1&&a[1][2]==1&&a[2][3]==1&&a[2][1]==1)||(a[1][1]==1&&a[1][2]==1&&a[2][2]==1&&a[2][3]==1)||(a[1][1]==1&&a[2][2]==1&&a[1][3]==1&&a[2][1]==1)){
				cout<<"3";return 0;
			}
			if((a[1][1]==1&&a[2][2]==1&&a[1][3]==1&&a[2][3]==1)||(a[2][2]==1&&a[1][2]==1&&a[1][3]==1&&a[2][1]==1)||(a[2][3]==1&&a[1][2]==1&&a[1][3]==1&&a[2][1]==1)){
				cout<<"3";return 0;
			}
		}
		if(ge==5){
			cout<<"4";return 0;
		}
		if(ge==6){
			cout<<"6";return 0;
		}
	}
	cout<<"1";
	fclose(stdin);
	fclose(stdout);
	return 0;
}
