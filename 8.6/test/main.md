
# 总述

出题人：150137

* 考试时间：3.5h
  * 测评机配置为 Intel Core i7-6700HQ CPU @ 2.60GHZ
* 测评环境是 Windows

考试共三道题，其中

* 第一题 Key 时间限制为 500ms， 空间限制为 256M
* 第二题 Tree 时间限制为 1s， 空间限制为 256M , 开启 -O2优化
* 第三题 Sum 时间限制为 2s， 空间限制 256M,  开启-O2优化

如果你Ak了可以大声呼喊 “我Ak 辣”来D出题人，但是不能装弱说 “我爆零了” 影响其他选手心情。

# A.密钥/ Key

## 题目描述

在这个问题中，一个密钥是指一个长度为 $3n$ 的二进制序列，其中 $n$ 是正整数。

序列的每一位从左往右依次被编号为 $1$ 到 $3n$ 。而一个密钥的权值是指相邻位不同的位置个数再加上 $1$。比如：`000` 的权值是 $1$，`011010100` 的权值是 $7$。

密钥可以被修改, 确切地说，可以不断进行下面的操作：选择任意两个相邻的位，然后同时取反它们。

比如我们可以通过一次操作把 `000` 修改为 `110` 。给定一个长度为 $3n$ 的密钥，请操作不超过 $n$ 次，将其修改为一个权值不少于 $2n$ 的密钥。你可以认为合法解必然存在。

## 输入格式

一行一个长度为 $3$ 的倍数 01 序列 $\{a\}$。

## 输出格式

第一行包含一个整数 $m$ ，表示操作的次数，你需要保证 $0\leq m\leq n$。

第二行包含$m$个正整数$a_1,a_2,...,a_m(1\leq a_i<n)$，依次表示每次翻转第$a_i$和第 $a_i+1$ 位。

如果初始密钥的权值已经不小于 $2n$ ，你可以仅输出一行一个整数 $0$。

## 样例输入

```text
111001000111
```

## 样例输出

``` text
2

3 9
```

## 约定 

本题共 50 个测试点,每个测试点 2 分。

对于所有数据总有 $1\leq n\leq 100000$， 保证数据很有梯度。



















# B. “树”点  / Tree

## 题目描述

从前有一棵 $n$ 个点的带边权的树，现在请你在树上找出 $k$ 个互不相同的点 $a_1.a_2.\dots.a_k$ ,使得 $\sum\limits_{i=1}^{k-1} \text{dis}(a_i,a_{i+1})$ 最小

其中 $\text{dis}(i,j)$ 表示 $i,j$ 两点在树上的最短路。

## 输入格式

第一行两个正整数 $n$, $k$ ,表示数的顶点数和需要选出的点个数。

接下来 $n-1$ 行每行 $3$个非负整数 $x$ $y$ $z$ ，表示从存在一条从 $x$ 到 $y$ 权值为 $z$ 的边。



## 输出格式

一行一个整数，表示最小的距离和。

## 样例输入

```
10 7

1 2 35129

2 3 42976

3 4 24497

2 5 83165

1 6 4748

5 7 38311

4 8 70052

3 9 3561

8 10 80238
```



## 样例输出

```
184524
```

## 数据规模与约定



对于 $10\%$ 的数据，  $n \leq 10$

对于 $30\%$ 的数据， $n \leq 50$

对于全部数据的一小部分，有 $n - k \leq 10$， 注意；这一部分和前 $30\%$ 有重叠。

对于$100\%$ 数据，$1 \leq n \le 3\times 10^3,1 \leq  k \leq n, 0 \leq z \leq 10^5$ 


















# C. 求和  / Sum

## 题目描述

给定一个序列 $\{a_n\}$ 支持以下两种操作

* 1  $l$   $r$  $z$ 区间 $[l,r]$ 内的每一个数字都加上一个数字 $z$
* 2  $l$  $r$    求 $\sum\limits_{i=l}^r fib(a_i)$

$fib(i)$ 表示斐波那契额数列的第 $i$ 项，其满足 

​					$$fib(1) = 1, fib(2) = 1, fib(x) = fib(x-1)+fib(x-2)$$

例如 序列

 ```
1 3 2 4 5 
 ```

2 2 3的结果就是  $fib(3)+fib(2)=2+1=3$

答案对 $10^9+7$ 取模

## 输入格式

第一行两个数字 $n， m$

第二行有 $n$ 个数字表示序列 $\{a_n\}$

从第三行开始共 $m$ 行每行为 1 l r z 或者 2 l r 分别表示一个修改或一个查询



## 输出格式

对于每一个询问给出如题目描述所述的值

## 样例输入

```
5 4
1 1 2 1 1
2 1 5
1 2 4 2
2 2 4
2 1 5
```



## 样例输出

```
5
7
9
```

## 数据规模与约定



对于 $50\%$ 的数据，  $n,m \leq 100$

对于$100\%$ 数据，$n \le 10^5, m \le 10^5, a_i \le 10^9$ 


